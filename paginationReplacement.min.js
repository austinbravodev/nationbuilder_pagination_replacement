/*! @license paginationReplacement | (c) Austin Bravo | Released under this license: https://github.com/austinbravodev/nationbuilder_pagination_replacement?tab=License-1-ov-file#readme | This notice must be included in all copies or substantial portions of this source code. */
function paginationReplacement(D){if(!DOMParser)return void console.info("`paginationReplacement` is not supported.");let{itemsContainerSelector:z,paginationContainerSelector:A,paginationContainerHide:e="none",previousPageCondition:n,nextPageCondition:B,sanitize:j=window.DOMPurify?.sanitize}=D;if("function"!=typeof j)console.warn("`paginationReplacement` is not enabled due to missing HTML sanitization function.");else{let R=document.querySelector(z),O=document.querySelector(A);if(n(O)){let I=PerformanceObserver.supportedEntryTypes.includes("navigation");var t,o;I?null!==history.state&&((t=history.state.prState)?(o=performance.getEntriesByType("navigation")).some(e=>"back_forward"===e.type)?(R.innerHTML=j(t.itemsContContents),O.innerHTML=j(t.pagContContents)):o.some(e=>"reload"===e.type)&&history.replaceState(null,""):(I=!1,console.warn("`paginationReplacement` is supported, but back and forward navigation will not function as intended due to `history.state` already being in use."))):console.warn("`paginationReplacement` is supported, but back and forward navigation will not function as intended.");let P=!0;if(!B(O)){let{paginationContainerShow:e="",nextPageUrl:n,makeButton:t,buttonSelector:o,buttonContainerSelector:i,buttonLoaded:r=e=>{e.disabled=!1},buttonLoading:a=e=>{e.disabled=!0},buttonContainerShow:s="",buttonContainerHide:l="none",makeMessages:c,messagesSelector:u,messagesContainerSelector:d,messagesContainerShow:g="",messagesContainerHide:p="none",loadingMessage:m="Loading...",messagesLoadingIconSelector:f,messagesLoadingIconShow:C="",messagesLoadingIconHide:y="none",errorMessage:b="An error occurred - please use pagination.",loadAll:S=!1}=D,h=!1,w=!1,v,L,M,H=O;if(t?{btn:L,btnCont:M=L,appendElement:H=H}=t(H):(L=document.querySelector(o),M=document.querySelector(i)||L,H=M??H),!L&&!S){if(!IntersectionObserver)return void console.info("`paginationReplacement` infinite scroll is unavailable.");h=!0}let T=new DOMParser;function F(){return fetch(n(O)).then(e=>{if(e.ok)return e.text();throw new Error("Error fetching next page: "+e.status)}).then(e=>{e=T.parseFromString(e,"text/html");return{itemsContContents:j(e.querySelector(z).innerHTML),pagContContents:j(e.querySelector(A).innerHTML)}})}let q=F(),k,x,E;function U(){if(w){if(!S)return}else L&&_(L,a),w=!0,k&&(k.textContent=m,E&&_(E,C),h||_(x,g));let n="";q.then(e=>{R.insertAdjacentHTML("beforeend",e.itemsContContents),O.innerHTML=e.pagContContents,I&&history.replaceState({prState:{itemsContContents:R.innerHTML,pagContContents:e.pagContContents}},"")}).catch(e=>{n=b,console.error(e.message)}).finally(()=>{if(n||B(O))L&&_(M,l),h&&v.unobserve(x),n&&_(O,e);else{if(q=F(),S)return void U();L&&_(L,r)}k&&(E&&_(E,y),n||h||_(x,p),k.textContent=n),w=!1})}c?{msgs:k,msgsCont:x=k,msgsLoadIcon:E}=c(H):(k=document.querySelector(u),x=document.querySelector(d)||k,E=document.querySelector(f)),h?(v=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&U()})})).observe(x):L?(L.addEventListener("click",U),_(L,r),_(M,s)):S?U():P=!1}function _(e,n){"string"==typeof n?e.style.display=n:"function"==typeof n?n(e):console.error("Display options must be string or function.")}P&&_(O,e)}else console.info("`paginationReplacement` is only enabled on the first page.")}}